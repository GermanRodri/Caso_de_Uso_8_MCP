/*==========================================================*
    *  Creacion de la base de datos restaurante             *
    *  Creado por: Angela Camila Montenegro Granados        *
                   Germán Esteban Rodriguez Garcia          *
                   Cristian Camilo Roncancio Peña           *
                   Cristhian Fernando Moreno Manrique       *
    *  Fecha: 12 - Octubre - 2025                           *
*==========================================================*/

DROP USER RESTAURANTE CASCADE;
CREATE USER RESTAURANTE IDENTIFIED BY A;
GRANT CONNECT, RESOURCE TO RESTAURANTE;
ALTER USER RESTAURANTE QUOTA UNLIMITED ON USERS;
CONN RESTAURANTE/A

-- ENTIDAD VENTAS --
CREATE TABLE VENTAS (
    ID_VENTA     NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1 MINVALUE 1 MAXVALUE 9999999999 NOCACHE),
    FECHA_VENTA  DATE       NOT NULL,
    CONSTRAINT PK_ID_VENTAS PRIMARY KEY (ID_VENTA)
);

--ENTIDAD PLATOS --
CREATE TABLE PLATOS (
    ID_PLATO    NUMBER(10)    GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1 MINVALUE 1 MAXVALUE 9999999999 NOCACHE),
    TIPO_PLATO  VARCHAR2(50)  NOT NULL,
    NOMBRE      VARCHAR2(200) NOT NULL,
    DESCRIPCION VARCHAR2(100) NOT NULL,
    CONSTRAINT PK_ID_PLATO PRIMARY KEY (ID_PLATO)
);

-- ENTIDAD MENUS
CREATE TABLE MENUS
(
    ID_MENU            NUMBER(10)    GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1 MINVALUE 1 MAXVALUE 9999999999 NOCACHE),
    DESCRIPCION_MENU   VARCHAR2(100) NOT NULL,
    CONSTRAINT PK_MENUS PRIMARY KEY (ID_MENU)
);

-- PLATOS_MENU (relación N:M entre PLATOS y MENUS)
CREATE TABLE PLATOS_MENU (
    ID_MENU  NUMBER(10)   NOT NULL,
    ID_PLATO NUMBER(10)   NOT NULL,
    PRECIO   NUMBER(10,2) NOT NULL,
    FECHA    DATE,
    CONSTRAINT PK_PLATOS_MENU PRIMARY KEY (ID_MENU, ID_PLATO),
    CONSTRAINT FK_PLATOS_MENU_MENU FOREIGN KEY (ID_MENU) REFERENCES MENUS(ID_MENU),
    CONSTRAINT FK_PLATOS_MENU_PLATO FOREIGN KEY (ID_PLATO) REFERENCES PLATOS(ID_PLATO)
);

-- ENTIDAD VENTAS_MENU 
CREATE TABLE VENTAS_MENU (
   ID_VENTAS_MENU NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1 MINVALUE 1 MAXVALUE 9999999999 NOCACHE),
   ID_MENU        NUMBER(10) NOT NULL,
   ID_VENTA       NUMBER(10) NOT NULL,
   CANTIDAD       NUMBER(10) NOT NULL,
   CONSTRAINT VENTAS_MENU PRIMARY KEY (ID_VENTAS_MENU),
   CONSTRAINT FK_VENTAS_MENU_VENTAS FOREIGN KEY (ID_VENTA) REFERENCES VENTAS(ID_VENTA),
   CONSTRAINT FK_VENTAS_MENU_MENU FOREIGN KEY (ID_MENU) REFERENCES MENUS(ID_MENU)
);
